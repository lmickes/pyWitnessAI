name: pywitnessai_cpu
channels:
  - conda-forge
  - defaults
dependencies:
  - python=3.10
  - pip
  - numpy=1.26.4
  - scipy=1.10.1

  # Optional: keep pandas and pillow on conda for faster solves
  - pandas=2.2.2
  - pillow=10.3.0

  # (Conda "variables" are supported in recent conda; if your conda is older, set these manually.)
  variables:
    KMP_DUPLICATE_LIB_OK: "TRUE"
    TF_ENABLE_ONEDNN_OPTS: "0"
    OMP_NUM_THREADS: "1"

  - pip:
      # DeepFace + versions that safely support legacy layers/models
      - deepface==0.0.95
      - tensorflow==2.12.1
      - keras==2.12.0
      - typing-extensions==4.5.0

      # Keep only ONE OpenCV wheel: contrib build includes extra modules (e.g., YUNet)
      - opencv-contrib-python==4.11.0.86
      - mtcnn==0.1.1

      # Detectors
      - ultralytics>=8.3,<9
      - mediapipe>=0.10,<0.11
      - retina-face>=0.0.14,<0.1

      # Recognition backends
      - torch==1.13.1
      - torchvision==0.14.1
      - onnxruntime==1.17.3
      - insightface==0.7.3
      - facenet-pytorch==2.5.3

      # dlib: pick one based on OS (markers are respected by pip)
      - dlib-bin==19.24.2; platform_system == "Windows"
      - dlib==19.24.2; platform_system != "Windows"

      # Jupyter stack versions compatible with typing-extensions==4.5.0
      - ipython==8.12.2
      - ipykernel==6.25.2
      - jupyter-client==8.6.1
